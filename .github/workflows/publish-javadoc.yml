name: Deploy JavaDoc
on:
  push:
    branches:
      - main
      - fardeenfs-patch-1

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up JDK 11
        uses: actions/setup-java@v1
        with:
          java-version: 11

      - name: Set up Android SDK
        uses: actions/setup-java@v1
        with:
          java-version: 11
          distribution: 'adopt'
        env:
          ANDROID_SDK_ROOT: /usr/local/lib/android/sdk

      - name: Build with Gradle
        run: ./gradlew assembleDebug
        working-directory: ./

      - name: Generate Javadoc
        run: |
          cd ${{ github.workspace }}
          ./gradlew javadoc -sourcepath $ANDROID_SDK_ROOT/platforms/android-30/android.jar -console=plain
          cp -R app/build/docs/javadoc/* javadocs/ 

      - name: Deploy JavaDoc ðŸš€
        uses: MathieuSoysal/Javadoc-publisher.yml@v2.4.0
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          javadoc-branch: javadocs
          java-version: 17
          target-folder: javadocs
          project: gradle
